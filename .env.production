# ===== PRODUCTION ENVIRONMENT CONFIGURATION =====
# IMPORTANT: This file contains production secrets. Store in encrypted secrets manager.
# Do not commit to version control. Generate new random values for each deployment.

# ===== Application Configuration =====
NODE_ENV=production
PORT=3000
LOG_LEVEL=warn
LOG_FORMAT=json

# ===== Database Configuration =====
# Generate strong random passwords (32+ characters)
DB_NAME=mangamotion_prod
DB_USER=mm_prod_user
DB_PASSWORD=<GENERATE_STRONG_PASSWORD_32_CHARS>
DATABASE_URL=postgresql://mm_prod_user:<GENERATE_STRONG_PASSWORD_32_CHARS>@postgres:5432/mangamotion_prod

# ===== Redis Configuration =====
REDIS_PASSWORD=<GENERATE_STRONG_PASSWORD_32_CHARS>
REDIS_URL=redis://:<GENERATE_STRONG_PASSWORD_32_CHARS>@redis:6379

# ===== RabbitMQ Configuration =====
RABBITMQ_USER=mm_prod_user
RABBITMQ_PASSWORD=<GENERATE_STRONG_PASSWORD_32_CHARS>
RABBITMQ_URL=amqp://mm_prod_user:<GENERATE_STRONG_PASSWORD_32_CHARS>@rabbitmq:5672

# ===== MinIO Configuration =====
# Generate cryptographically secure keys
MINIO_ACCESS_KEY=<GENERATE_ACCESS_KEY_20_CHARS>
MINIO_SECRET_KEY=<GENERATE_SECRET_KEY_40_CHARS>
MINIO_BUCKET=mangamotion-prod
S3_ENDPOINT=http://minio:9000
S3_ACCESS_KEY=<GENERATE_ACCESS_KEY_20_CHARS>
S3_SECRET_KEY=<GENERATE_SECRET_KEY_40_CHARS>
S3_REGION=us-east-1
S3_BUCKET=mangamotion-prod
S3_FORCE_PATH_STYLE=true

# ===== File Upload Configuration =====
MAX_FILE_SIZE_MB=500
MAX_UPLOAD_BYTES=524288000
USER_UPLOAD_QUOTA_MB=5000
QUOTA_WINDOW_HOURS=24
RATE_LIMIT_JOBS_PER_MINUTE=5

# ===== Authentication & Security Secrets =====
# Generate cryptographically secure random strings (64+ characters)
JWT_SECRET=<GENERATE_JWT_SECRET_64_CHARS_RANDOM>
JWT_REFRESH_SECRET=<GENERATE_REFRESH_SECRET_64_CHARS_RANDOM>
WORKER_SECRET=<GENERATE_WORKER_SECRET_32_CHARS>

# ===== Stripe Payment Configuration =====
# Use live production keys from Stripe dashboard
STRIPE_PUBLISHABLE_KEY=pk_live_<YOUR_STRIPE_PUBLISHABLE_KEY>
STRIPE_SECRET_KEY=sk_live_<YOUR_STRIPE_SECRET_KEY>
STRIPE_WEBHOOK_SECRET=whsec_<YOUR_STRIPE_WEBHOOK_SECRET>

# ===== Monitoring & Observability =====
# Sentry for error tracking and performance monitoring
SENTRY_DSN=https://<YOUR_SENTRY_DSN>@o<YOUR_SENTRY_ORG_ID>.ingest.sentry.io/<YOUR_SENTRY_PROJECT_ID>
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.1

# ===== Production Service Configuration =====
# ClamAV malware scanning (production enabled)
CLAMAV_ENABLED=true
CLAMAV_HOST=clamav
CLAMAV_PORT=3310
CLAMAV_TIMEOUT_MS=30000
SCAN_ON_UPLOAD=true

# Tracing (OpenTelemetry + Jaeger)
TRACING_ENABLED=true
JAEGER_HOST=jaeger
JAEGER_PORT=6831
JAEGER_SAMPLER=probabilistic
JAEGER_SAMPLER_PARAM=0.1
SERVICE_NAME=mangamotion-backend

# ===== Worker Configuration =====
SCAN_WORKER_CONCURRENCY=2
WORKER_CONCURRENCY=2
MAX_JOB_DURATION=600
COST_PER_JOB_LIMIT=0.50

# ===== Monitoring Services =====
GRAFANA_USER=admin
GRAFANA_PASSWORD=<GENERATE_GRAFANA_PASSWORD_32_CHARS>

PGADMIN_EMAIL=admin@yourdomain.com
PGADMIN_PASSWORD=<GENERATE_PGADMIN_PASSWORD_32_CHARS>

# ===== Rate Limiting Configuration =====
# Per-user and global rate limits
RATE_LIMIT_UPLOAD_PER_MINUTE=3
RATE_LIMIT_GENERATE_PER_MINUTE=2
RATE_LIMIT_GLOBAL_PER_SECOND=10

# ===== Backup Configuration =====
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
S3_BACKUP_BUCKET=mangamotion-backups-prod

# ===== SSL/TLS Configuration =====
SSL_CERT_PATH=/etc/letsencrypt/live/yourdomain.com/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/yourdomain.com/privkey.pem

# ===== Cost Controls =====
MAX_CONCURRENT_JOBS=10
JOB_TIMEOUT_SECONDS=600
MAX_DAILY_COST_PER_USER=25.00
GLOBAL_COST_LIMIT=500.00

# ===== Content Security =====
ALLOWED_EXTENSIONS=jpg,jpeg,png,gif,bmp,webp,mp4,avi,mov,mkv
ALLOWED_CONTENT_TYPES=image/jpeg,image/png,image/gif,image/bmp,image/webp,video/mp4,video/x-msvideo,video/quicktime,video/x-matroska

# ===== External Service URLs =====
# Replace with your production domain
PRODUCTION_URL=https://yourdomain.com
API_BASE_URL=https://yourdomain.com/api
WEBHOOK_BASE_URL=https://yourdomain.com/webhooks

# ===== Performance Tuning =====
DB_POOL_MIN=2
DB_POOL_MAX=20
REDIS_POOL_SIZE=10
RABBITMQ_PREFETCH=5

# ===== Security Headers =====
CORS_ORIGIN=https://yourdomain.com
HELMET_ENABLED=true
SESSION_SECRET=<GENERATE_SESSION_SECRET_64_CHARS>

# ===== Deployment Metadata =====
DEPLOY_VERSION=<DEPLOYMENT_VERSION_OR_COMMIT_SHA>
DEPLOY_TIMESTAMP=<UNIX_TIMESTAMP>
DEPLOY_ENVIRONMENT=production